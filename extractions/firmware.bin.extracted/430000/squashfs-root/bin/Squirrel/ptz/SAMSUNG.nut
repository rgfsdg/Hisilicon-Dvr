class Samsung extends PtzBase{
	// 协议的显示名称, 最好与文件名直接对应，不能超过16字符
	Name = "SAMSUNG"
		
	// 指明是云台协议还是矩阵协议，使用"PTZ", "MATRIX"表示
	Type = "PTZ"
	
	// 以ms为单位
	Internal = 200		
	
	// 一下地址范围如无对应的地址范围，都设成0xFF
	
	// 云台地址范围
	CamAddrRange 		= [0x00, 0xFF]
	
	// 监视地址范围
	MonAddrRange		= [0x00, 0xFF]
	
	// 预置点范围
	PresetRange 		= [0x00, 0xFF]
	
	// 自动巡航线路范围
	TourRange			= [0xFF, 0xFF]
	
	// 轨迹线路范围
	PatternRange		= [1, 3]
	
	// 垂直速度范围
	TileSpeedRange 		= [0x00, 0x40]
	
	// 水平速度范围
	PanSpeedRange 		= [0x00, 0x40]
	
	// 辅助范围
	AuxRange 			= [0x01, 0x08]
	
	AddrPos 			= 2
	PresetPos 		= 5
	TileSpeedPos 	= 7
	PanSpeedPos 	= 6
	PatternPos 		= 5
	AuxPos 				= 5
	
	cmd = []
	
	StartOpr = {
		TileUp 		= [0xA0, 0x00, 0x00, 0x01, 0x00, 0x04, 0x00, 0x00, 0x00],
		TileDown 	= [0xA0, 0x00, 0x00, 0x01, 0x00, 0x08, 0x00, 0x00, 0x00],
		PanLeft 	= [0xA0, 0x00, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00],
		PanRight 	= [0xA0, 0x00, 0x00, 0x01, 0x00, 0x02, 0x00, 0x00, 0x00],
		LeftUp 		= [0xA0, 0x00, 0x00, 0x01, 0x00, 0x05, 0x00, 0x00, 0x00],
		LeftDown 	= [0xA0, 0x00, 0x00, 0x01, 0x00, 0x09, 0x00, 0x00, 0x00],
		RightUp		= [0xA0, 0x00, 0x00, 0x01, 0x00, 0x06, 0x00, 0x00, 0x00],
		RightDown = [0xA0, 0x00, 0x00, 0x01, 0x00, 0x0A, 0x00, 0x00, 0x00],
		
		ZoomWide 	= [0xA0, 0x00, 0x00, 0x01, 0x40, 0x00, 0x00, 0x00, 0x00],
		ZoomTele 	= [0xA0, 0x00, 0x00, 0x01, 0x20, 0x00, 0x00, 0x00, 0x00],
		FocusNear	= [0xA0, 0x00, 0x00, 0x01, 0x02, 0x00, 0x00, 0x00, 0x00],
		FocusFar 	= [0xA0, 0x00, 0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00],
		IrisSmall	= [0xA0, 0x00, 0x00, 0x01, 0x10, 0x00, 0x00, 0x00, 0x00],
		IrisLarge	= [0xA0, 0x00, 0x00, 0x01, 0x08, 0x00, 0x00, 0x00, 0x00],	
		
		SetPreset 	= [0xA0, 0x00, 0x00, 0x03, 0x50, 0x00, 0xFF, 0xFF, 0x00],
		ClearPreset	= [0xA0, 0x00, 0x00, 0x03, 0x51, 0x00, 0xFF, 0xFF, 0x00],
		GoToPreset 	= [0xA0, 0x00, 0x00, 0x03, 0x19, 0x00, 0xFF, 0xFF, 0x00],
		
		AutoPanOn	  = [0xA0, 0x00, 0x00, 0x03, 0x1A, 0x01, 0xFF, 0xFF, 0x00],
		AutoPanOff	= [0xA0, 0x00, 0x00, 0x03, 0x1A, 0x00, 0xFF, 0xFF, 0x00],
		
		AutoScanOn 		= [0xA0, 0x00, 0x00, 0x03, 0x13, 0x01, 0xFF, 0xFF, 0x00],
		AutoScanOff		= [0xA0, 0x00, 0x00, 0x03, 0x13, 0x00, 0xFF, 0xFF, 0x00],
		
		StartPattern 		= [0xA0, 0x00, 0x00, 0x03, 0x1B, 0x00, 0x01, 0xFF, 0x00],
    StopPattern     = [0xA0, 0x00, 0x00, 0x03, 0x1B, 0x00, 0x00, 0xFF, 0x00],
    
    Menu 			= [0xA0, 0x00, 0x00, 0x03, 0x17, 0x01, 0xFF, 0xFF, 0x00],
		MenuExit 	= [0xA0, 0x00, 0x00, 0x03, 0x17, 0x00, 0xFF, 0xFF, 0x00],
		MenuEnter = [0xA0, 0x00, 0x00, 0x03, 0x18, 0xFF, 0xFF, 0xFF, 0x00],
		MenuUp 		= [0xA0, 0x00, 0x00, 0x03, 0x03, 0xFF, 0xFF, 0xFF, 0x00],
		MenuDown 	= [0xA0, 0x00, 0x00, 0x03, 0x09, 0xFF, 0xFF, 0xFF, 0x00],
		MenuLeft	= [0xA0, 0x00, 0x00, 0x03, 0x05, 0xFF, 0xFF, 0xFF, 0x00],
		MenuRight = [0xA0, 0x00, 0x00, 0x03, 0x07, 0xFF, 0xFF, 0xFF, 0x00],
		
		Position  = [0xA0, 0x00, 0x01, 0x20, 0x00, 0x05, 0x00, 0xFF, 0x00, 0xA0, 0x00, 0x01, 0x30, 0x01, 0x00, 0x50, 0xFF, 0x00, 0xA0, 0x00, 0x01, 0x40, 0x00, 0x0D, 0x2C, 0xFF, 0x00]
	}
	
	StopOpr = {
		TileUp 		= [0xA0, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00],
		TileDown 	= [0xA0, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00],
		PanLeft 	= [0xA0, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00],
		PanRight 	= [0xA0, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00],
		LeftUp 		= [0xA0, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00],
		LeftDown 	= [0xA0, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00],
		RightUp		= [0xA0, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00],
		RightDown = [0xA0, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00],
		
		ZoomWide 	= [0xA0, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00],
		ZoomTele 	= [0xA0, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00],
		FocusNear = [0xA0, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00],
		FocusFar 	= [0xA0, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00],
		IrisSmall = [0xA0, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00],
		IrisLarge = [0xA0, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00]
	}
	
	function CheckSum()
	{
		if (9 == cmd.len())
		{
			local sum = cmd[1] + cmd[2] + cmd[3] + cmd[4] + cmd[5] + cmd[6] + cmd[7];
			cmd[8] = (0xFFFF - sum) & 0xff;
		}
		else
		{
			local sum1 = cmd[1] + cmd[2] + cmd[3] + cmd[4] + cmd[5] + cmd[6] + cmd[7];
			cmd[8] = (0xFFFF - sum1) & 0xff;
		
			local sum2 = cmd[10] + cmd[11] + cmd[12] + cmd[13] + cmd[14] + cmd[15] + cmd[16];
			cmd[17] = (0xFFFF- sum2) & 0xff;
		
			local sum3 = cmd[19] + cmd[20] + cmd[21] + cmd[22] + cmd[23] + cmd[24] + cmd[25];
			cmd[26] = (0xFFFF - sum3) & 0xff;
		}
	}
	
	function setCamAddr(addr)
	{
		if (cmd.len() == 9)
		{
			cmd[2] = addr % 256;
		}
		else
		{
			cmd[2] = addr;
			cmd[11] = addr;
			cmd[20] = addr;
		}
	}
	
	function setSpeed(ver, hor)
  {
  	if (cmd[5] != 0)
	  {
	  	cmd[TileSpeedPos] = ver;
	  	cmd[PanSpeedPos] = hor;
	  }
  }
  
  function setPosition(hor1, ver1, hor2, ver2)
	{
		local hor = ((hor1 + hor2)/2 - 4096) * 2;
  	local ver = ((ver1 + ver2)/2 - 4096) * 2;
  	local zoom = 0;
  	if((hor1 == hor2) || (ver1 == ver2))
  	{
  		zoom = 0;
  	}
  	else
  	{
  		zoom = (8192/(hor2 - hor1)) * (8192/(ver2 - ver1));
  		if(ver1 < ver2)
  		{
  			zoom = abs(zoom);
  		}
  		else
  		{
  			zoom = -abs(zoom);
  		}
  	}
  	
		local max_pos_zoom = 22;
		local zoom_num_table = [0x008,0x574,0x7B8,0x90C,0x9F4,0xAA0,0xB2C,0xBA0,0xC04,0xC58,0xCA4,0xCEC,0xD28, 0xD5C,0xD8C,0xDB4,0xDD8,0xDF8,0xE10,0xE28,0xE38,0xE44];
		
		//print("hor: "+hor+", ver: "+ver+", zomm: "+zoom+"\n");
		if (hor >= 0)
		{
			print("right");
			cmd[4] = 0x00;
		}
		else 
		{
			print("left");
			cmd[4] = 0x01;
		}
		hor = abs(hor);
		
		if (ver >= 0)
		{
			print("down");
			cmd[13] = 0x01;
		}
		else
		{
			print("up");
			cmd[13] = 0x00;
		}
		ver = abs(ver);
		
		if (zoom > 0)
		{
			print("room tele");
			cmd[22] = 0x00;
		}
		else
		{
			print("room wide");
			cmd[22] = 0x01;
		}
		local zoom_value = (abs(zoom) & 0x7f) % 0x04;
		print("zoom_value: "+zoom_value+"");
		
		local pan = hor / 80;
		cmd[5] = (pan / 256) & 0xff;
		cmd[6] = (pan % 256) & 0xff;
		
		local tilt = ver / 226;
		cmd[14] = (tilt % 256) & 0xff;
		cmd[15] = (tilt % 256) & 0xff;
		
		if (zoom_value >= 1)
		{
			local zoom_num = zoom_num_table[zoom_value - 1];
			cmd[23] = (zoom_num / 256) & 0xff;
			cmd[24] = (zoom_num % 256) & 0xff;
		}
	}
}

local cSamsung = Samsung();

return cSamsung;