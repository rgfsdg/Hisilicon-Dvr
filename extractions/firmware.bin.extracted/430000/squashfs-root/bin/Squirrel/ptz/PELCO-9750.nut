class Pelco9750 extends PtzBase{
	// 协议的显示名称, 最好与文件名直接对应，不能超过16字符
	Name = "PELCO-9750"
		
	// 指明是云台协议还是矩阵协议，使用"PTZ", "MATRIX"表示
	Type = "MATRIX"
	
	// 以ms为单位
	Internal = 250		
	
	// 一下地址范围如无对应的地址范围，都设成0xFF
	
	// 云台地址范围
	CamAddrRange 		= [0x00, 0xFF]
	
	// 监视地址范围
	MonAddrRange		= [0x00, 0xFF]
	
	// 预置点范围
	PresetRange 		= [0x01, 0x20]
	
	// 自动巡航线路范围
	TourRange			= [0x01, 0xFF]
	
	// 轨迹线路范围
	PatternRange		= [0x01, 0xFF]
	
	// 垂直速度范围
	TileSpeedRange 		= [0x01, 0x3F]
	
	// 水平速度范围
	PanSpeedRange 		= [0x01, 0x3F]
	
	// 辅助范围
	AuxRange 			= [0x01, 0x08]
	
	AddrPos 			= 1
	PresetPos 		= 5
	TileSpeedPos 	= 8
	PanSpeedPos 	= 7
	AuxPos 				= 5
	
	cmd = []
	
	StartOpr = {
		TileUp 		= [0xA0, 0xC0, 0x00, 0x00, 0x01, 0x00, 0x08, 0x00, 0x00, 0xAF, 0x00],
		TileDown 	= [0xA0, 0xC0, 0x00, 0x00, 0x01, 0x00, 0x10, 0x00, 0x00, 0xAF, 0x00],
		PanLeft 	= [0xA0, 0xC0, 0x00, 0x00, 0x01, 0x00, 0x04, 0x00, 0x00, 0xAF, 0x00],
		PanRight 	= [0xA0, 0xC0, 0x00, 0x00, 0x01, 0x00, 0x02, 0x00, 0x00, 0xAF, 0x00],
		LeftUp 		= [0xA0, 0xC0, 0x00, 0x00, 0x01, 0x00, 0x0C, 0x00, 0x00, 0xAF, 0x00],
		LeftDown 	= [0xA0, 0xC0, 0x00, 0x00, 0x01, 0x00, 0x14, 0x00, 0x00, 0xAF, 0x00],
		RightUp		= [0xA0, 0xC0, 0x00, 0x00, 0x01, 0x00, 0x0A, 0x00, 0x00, 0xAF, 0x00],
		RightDown = [0xA0, 0xC0, 0x00, 0x00, 0x01, 0x00, 0x12, 0x00, 0x00, 0xAF, 0x00],
		
		ZoomWide 	= [0xA0, 0xC0, 0x00, 0x00, 0x01, 0x00, 0x40, 0x00, 0x00, 0xAF, 0x00],
		ZoomTele 	= [0xA0, 0xC0, 0x00, 0x00, 0x01, 0x00, 0x20, 0x00, 0x00, 0xAF, 0x00],
		FocusNear	= [0xA0, 0xC0, 0x00, 0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 0xAF, 0x00],
		FocusFar 	= [0xA0, 0xC0, 0x00, 0x00, 0x01, 0x00, 0x80, 0x00, 0x00, 0xAF, 0x00],
		IrisSmall	= [0xA0, 0xC0, 0x00, 0x00, 0x01, 0x04, 0x00, 0x00, 0x00, 0xAF, 0x00],
		IrisLarge	= [0xA0, 0xC0, 0x00, 0x00, 0x01, 0x02, 0x00, 0x00, 0x00, 0xAF, 0x00],	
		
		MatrixSwitch = [0xA0, 0xB2, 0x00, 0x00, 0x01, 0xAF, 0x00]
	}
	
	StopOpr = {
		TileUp 		= [0xA0, 0xC5, 0x00, 0x00, 0x01, 0x00, 0x08, 0x00, 0x00, 0xAF, 0x00],
		TileDown 	= [0xA0, 0xC5, 0x00, 0x00, 0x01, 0x00, 0x10, 0x00, 0x00, 0xAF, 0x00],
		PanLeft 	= [0xA0, 0xC5, 0x00, 0x00, 0x01, 0x00, 0x04, 0x00, 0x00, 0xAF, 0x00],
		PanRight 	= [0xA0, 0xC5, 0x00, 0x00, 0x01, 0x00, 0x02, 0x00, 0x00, 0xAF, 0x00],
		LeftUp 		= [0xA0, 0xC5, 0x00, 0x00, 0x01, 0x00, 0x0C, 0x00, 0x00, 0xAF, 0x00],
		LeftDown 	= [0xA0, 0xC5, 0x00, 0x00, 0x01, 0x00, 0x14, 0x00, 0x00, 0xAF, 0x00],
		RightUp		= [0xA0, 0xC5, 0x00, 0x00, 0x01, 0x00, 0x0A, 0x00, 0x00, 0xAF, 0x00],
		RightDown = [0xA0, 0xC5, 0x00, 0x00, 0x01, 0x00, 0x12, 0x00, 0x00, 0xAF, 0x00],
		
		ZoomWide 	= [0xA0, 0xC5, 0x00, 0x00, 0x01, 0x00, 0x40, 0x00, 0x00, 0xAF, 0x00],
		ZoomTele 	= [0xA0, 0xC5, 0x00, 0x00, 0x01, 0x00, 0x20, 0x00, 0x00, 0xAF, 0x00],
		FocusNear = [0xA0, 0xC5, 0x00, 0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 0xAF, 0x00],
		FocusFar 	= [0xA0, 0xC5, 0x00, 0x00, 0x01, 0x00, 0x80, 0x00, 0x00, 0xAF, 0x00],
		IrisSmall = [0xA0, 0xC5, 0x00, 0x00, 0x01, 0x04, 0x00, 0x00, 0x00, 0xAF, 0x00],
		IrisLarge = [0xA0, 0xC5, 0x00, 0x00, 0x01, 0x02, 0x00, 0x00, 0x00, 0xAF, 0x00]
	}
	
	function CheckSum()
	{
		if (cmd.len() == 7)
		{
			cmd[6] = (cmd[1] + cmd[2] + cmd[3] + cmd[4]) % 256;
		}
		else
		{
			cmd[10] = (cmd[1] + cmd[2] + cmd[3] + cmd[4] + cmd[5] + cmd[6] + cmd[7] + cmd[8]) % 256;
		}
	}
	
	function setCamAddr(addr)
	{
		cmd[3] = addr / 256;
		cmd[4] = addr % 256;
	}
  
	function setMonAddr(addr)
	{
		cmd[3] = addr % 256;
	}
	
	function setSpeed(ver, hor)
  {
  	if (cmd[1] != 0xC5)
	  {
	  	cmd[8] = ver;
	  	cmd[7] = hor;
	  }
  }
  
  function OprSwitch(MonAddr, CamAddr)
	{
		setMonAddr(MonAddr);
		setCamAddr(CamAddr);
	}
}

local cPelco9750 = Pelco9750();

return cPelco9750;